/*
Generated by cue.

No description provided (generated by Openapi Generator https://github.com/openapitools/openapi-generator)

API version: no version
*/

// Code generated by OpenAPI Generator (https://openapi-generator.tech); DO NOT EDIT.

package shared_resource

import (
	"encoding/json"

	"github.com/oam-dev/kubevela-core-api/apis/core.oam.dev/v1beta1"
	"github.com/oam-dev/kubevela-core-api/pkg/oam/util"

	"github.com/kubevela-contrib/kubevela-go-sdk/pkg/apis"
	sdkcommon "github.com/kubevela-contrib/kubevela-go-sdk/pkg/apis/common"
	"github.com/kubevela-contrib/kubevela-go-sdk/pkg/apis/utils"
)

// checks if the SharedResourceSpec type satisfies the MappedNullable interface at compile time
var _ utils.MappedNullable = &SharedResourceSpec{}

// SharedResourceSpec struct for SharedResourceSpec
type SharedResourceSpec struct {
	// Specify the list of rules to control shared-resource strategy at resource level. The selected resource will be sharable across applications. (That means multiple applications can all read it without conflict, but only the first one can write it)
	Rules []SharedResourcePolicyRule `json:"rules,omitempty"`
}

// NewSharedResourceSpecWith instantiates a new SharedResourceSpec object
// This constructor will make sure properties required by API are set.
// For optional properties, it will set default values if they have been defined.
// The set of arguments will change when the set of required properties is changed
func NewSharedResourceSpecWith() *SharedResourceSpec {
	this := SharedResourceSpec{}
	return &this
}

// NewSharedResourceSpecWithDefault instantiates a new SharedResourceSpec object
// This constructor will only assign default values to properties that have it defined,
// but it doesn't guarantee that properties required by API are set
func NewSharedResourceSpecWithDefault() *SharedResourceSpec {
	this := SharedResourceSpec{}
	return &this
}

// NewSharedResourceSpec is short for NewSharedResourceSpecWithDefault which instantiates a new SharedResourceSpec object.
// This constructor will only assign default values to properties that have it defined,
// but it doesn't guarantee that properties required by API are set
func NewSharedResourceSpec() *SharedResourceSpec {
	return NewSharedResourceSpecWithDefault()
}

// NewSharedResourceSpecEmpty instantiates a new SharedResourceSpec object with no properties set.
// This constructor will not assign any default values to properties.
func NewSharedResourceSpecEmpty() *SharedResourceSpec {
	this := SharedResourceSpec{}
	return &this
}

// NewSharedResourceSpecs converts a list SharedResourceSpec pointers to objects.
// This is helpful when the SetSharedResourceSpec requires a list of objects
func NewSharedResourceSpecList(ps ...*SharedResourceSpec) []SharedResourceSpec {
	objs := []SharedResourceSpec{}
	for _, p := range ps {
		objs = append(objs, *p)
	}
	return objs
}

// Validate validates this SharedResourceSpec
// 1. If the required properties are not set, this will return an error
// 2. If properties are set, will check if nested required properties are set
func (o *SharedResourcePolicy) Validate() error {
	// validate all nested properties
	return nil
}

// GetRules returns the Rules field value if set, zero value otherwise.
func (o *SharedResourcePolicy) GetRules() []SharedResourcePolicyRule {
	if o == nil || utils.IsNil(o.Properties.Rules) {
		var ret []SharedResourcePolicyRule
		return ret
	}
	return o.Properties.Rules
}

// GetRulesOk returns a tuple with the Rules field value if set, nil otherwise
// and a boolean to check if the value has been set.
func (o *SharedResourcePolicy) GetRulesOk() ([]SharedResourcePolicyRule, bool) {
	if o == nil || utils.IsNil(o.Properties.Rules) {
		return nil, false
	}
	return o.Properties.Rules, true
}

// HasRules returns a boolean if a field has been set.
func (o *SharedResourcePolicy) HasRules() bool {
	if o != nil && !utils.IsNil(o.Properties.Rules) {
		return true
	}

	return false
}

// SetRules gets a reference to the given []SharedResourcePolicyRule and assigns it to the rules field.
// Rules:  Specify the list of rules to control shared-resource strategy at resource level. The selected resource will be sharable across applications. (That means multiple applications can all read it without conflict, but only the first one can write it)
func (o *SharedResourcePolicy) SetRules(v []SharedResourcePolicyRule) *SharedResourcePolicy {
	o.Properties.Rules = v
	return o
}

func (o SharedResourceSpec) MarshalJSON() ([]byte, error) {
	toSerialize, err := o.ToMap()
	if err != nil {
		return []byte{}, err
	}
	return json.Marshal(toSerialize)
}

func (o SharedResourceSpec) ToMap() (map[string]interface{}, error) {
	toSerialize := map[string]interface{}{}
	if !utils.IsNil(o.Rules) {
		toSerialize["rules"] = o.Rules
	}
	return toSerialize, nil
}

type NullableSharedResourceSpec struct {
	value *SharedResourceSpec
	isSet bool
}

func (v *NullableSharedResourceSpec) Get() *SharedResourceSpec {
	return v.value
}

func (v *NullableSharedResourceSpec) Set(val *SharedResourceSpec) {
	v.value = val
	v.isSet = true
}

func (v *NullableSharedResourceSpec) IsSet() bool {
	return v.isSet
}

func (v *NullableSharedResourceSpec) Unset() {
	v.value = nil
	v.isSet = false
}

func NewNullableSharedResourceSpec(val *SharedResourceSpec) *NullableSharedResourceSpec {
	return &NullableSharedResourceSpec{value: val, isSet: true}
}

func (v NullableSharedResourceSpec) MarshalJSON() ([]byte, error) {
	return json.Marshal(v.value)
}

func (v *NullableSharedResourceSpec) UnmarshalJSON(src []byte) error {
	v.isSet = true
	return json.Unmarshal(src, &v.value)
}

const SharedResourceType = "shared-resource"

func init() {
	sdkcommon.RegisterPolicy(SharedResourceType, FromPolicy)
}

type SharedResourcePolicy struct {
	Base       apis.PolicyBase
	Properties SharedResourceSpec
}

func SharedResource(name string) *SharedResourcePolicy {
	s := &SharedResourcePolicy{Base: apis.PolicyBase{
		Name: name,
		Type: SharedResourceType,
	}}
	return s
}

func (s *SharedResourcePolicy) Build() v1beta1.AppPolicy {
	res := v1beta1.AppPolicy{
		Name:       s.Base.Name,
		Properties: util.Object2RawExtension(s.Properties),
		Type:       SharedResourceType,
	}
	return res
}

func (s *SharedResourcePolicy) FromPolicy(from v1beta1.AppPolicy) (*SharedResourcePolicy, error) {
	var properties SharedResourceSpec
	if from.Properties != nil {
		err := json.Unmarshal(from.Properties.Raw, &properties)
		if err != nil {
			return nil, err
		}
	}
	s.Base.Name = from.Name
	s.Base.Type = SharedResourceType
	s.Properties = properties
	return s, nil
}

func FromPolicy(from v1beta1.AppPolicy) (apis.Policy, error) {
	s := &SharedResourcePolicy{}
	return s.FromPolicy(from)
}

func (s *SharedResourcePolicy) PolicyName() string {
	return s.Base.Name
}

func (s *SharedResourcePolicy) DefType() string {
	return SharedResourceType
}
